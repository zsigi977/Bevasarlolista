<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bev√°s√°rl√≥lista</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icon.png">
    <style>
        /* A st√≠lusod v√°ltozatlan marad... */
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: #f2f2f7; color: #000; margin: 0; padding: 20px; min-height: 100vh; }
        h1 { text-align: center; }
        .controls { display: flex; gap: 10px; margin-bottom: 15px; }
        select, input, button { padding: 10px; border-radius: 8px; border: 1px solid #ccc; font-size: 16px; }
        button { cursor: pointer; }
        ul { list-style: none; padding: 0; }
        li { background: white; padding: 12px; border-radius: 10px; display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; cursor: grab; }
        .left { display: flex; align-items: center; gap: 10px; }
        .checked { text-decoration: line-through; color: gray; }
        .delete { background: none; border: none; font-size: 18px; color: red; }
    </style>
</head>
<body>

<div id="login" style="text-align:center; margin-top:50px;">
    <h2>Jelsz√≥ a Bev√°s√°rl√≥list√°hoz</h2>
    <input type="password" id="passInput" placeholder="Jelsz√≥" />
    <button id="loginBtn">Bel√©p√©s</button>
    <p id="error" style="color:red;"></p>
</div>

<div id="app" style="display:none;">
    <h1>üõí Bev√°s√°rl√≥lista</h1>
    <div class="controls">
        <input type="text" id="itemInput" placeholder="√öj term√©k" />
        <button id="addBtn">‚ûï</button>
    </div>
    <div class="controls">
        <select id="storeSelect">
            <option value="aldi">Aldi</option>
            <option value="lidl">Lidl</option>
            <option value="spar">Spar</option>
        </select>
        <button id="clearBtn">üóëÔ∏è Lista t√∂rl√©se</button>
    </div>
    <ul id="list"></ul>
</div>

<script type="module">
    // 1. Firebase import√°l√°sa
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    // 2. SAJ√ÅT KONFIGUR√ÅCI√ìD (M√°sold ki a Firebase Konzolb√≥l!)
const firebaseConfig = {
  apiKey: "AIzaSyCslE4Kc229j41Sm2l7ovpc_KEWhOb107k",
  authDomain: "bevasarlolista-dd660.firebaseapp.com",
  projectId: "bevasarlolista-dd660",
  storageBucket: "bevasarlolista-dd660.firebasestorage.app",
  messagingSenderId: "482885096675",
  appId: "1:482885096675:web:f569deb724cb835358e1d6",
  measurementId: "G-C6LVZZB2EF"
};

    // Firebase inicializ√°l√°sa
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const itemsRef = ref(db, 'items');

    const PASSWORD = "999111";
    let items = [];

    const storeOrders = {
        aldi: ["k√°v√©", "tea", "lekv√°r", "nutella", "mogyor√≥vaj", "gabonapehely", "keksz", "csoki", "gumicukor", "√©dess√©g", "r√°gcsa", "snack", "chips", "mogyor√≥", "ban√°n", "alma", "narancs", "citrom", "v√©rnarancs", "sz≈ël≈ë", "gy√ºm√∂lcs", "mandarin", "gomba", "krumpli", "bor","feh√©rbor","v√∂r√∂sbor","vodka","gagyi vodka","gagyivodka","pezsg≈ë","s√∂r", "mosogat√≥g√©p s√≥", "√∂bl√≠t≈ë", "mos√≥szer", "v√≠zk≈ëold√≥", "szemeteszs√°k", "kuk√°szs√°k", "kukazs√°k","tiszt√≠t√≥szer","mosogat√≥g√©p kapszula","tusf√ºrd≈ë","sampon","vattapamacs","fogkefe","fogkr√©m","dezodor","hagyma","fokhagyma","paparika","paradicsom","√∫jhagyma","t√∂k","lilahagyma","r√©pa","levesz√∂lsd√©g","zeller","passata","paradicsomp√ºr√©","paradicsom p√ºr√©","paprikakr√©m","kukorica","konzerv kukorica","kukorica konzerv","saviubi","savany√∫ uborka","paprikakr√©m","paprika kr√©m","guly√°skr√©m","olivbogy√≥","olivabogy√≥","t√©szta","mamat√©szta","mama t√©szta","szarvacska","spagetti","farfelle","penne","rizs","rizsa","tarhonya","cica kaja","pamacskaja","macska kaja","macskakaja","macska alom", "macskaalom", "cica alom", "cicaalom","olaj","olivaolaj","oliva olaj","liszt","s√≥","cukor","barna cukor","van√≠li√°s cukor","aroma","van√≠lia aroma","rum aroma","citroml√©","limel√©","mirelit","mirelit bors√≥","bors√≥","mirelit kukorica","mirelit brokkoli","brokkoli","z√∂ldbab","mirelit z√∂ldbab","mexik√≥i","vegyes z√∂lsd√©g","mirelit z√∂lds√©g","h√∫s","csirkecomb","csirke comb","comb","sert√©s comb","karaj","tarja","oldalas","sz≈±z","hal","lazac","leves mix","levesmix","m√°j","kolb√°sz","sz√°razkolb√°sz","sz√°raz kolb√°sz","szalonna","kolozsv√°ri szalonna","cs√°sz√°r szalonna","kolozsv√°riszalonna","cs√°sz√°rszalonna","felv√°gott","sonka","szal√°mi","virsli","f≈±szerek","oreg√°no","kakukkf≈±","majoranna","bors","tarkabors","sz√≠nesbors","kapor","fokhagymapor","fokhagyma por","fokhagymagranul√°tum","fokhagyma granul√°tum","leveskocka","ketchup","kecsap","majon√©z","must√°r","sajt","kem√©nysajt","lapka sajt","lapkasajt","parmez√°n","grana padano","sajtkr√©m","sajt kr√©m","kr√©msajt","tejf√∂l","joghurt","tej","tejsz√≠n","tejsz√≠nhab","toj√°s","keny√©r","kifli","zsemle","tortilla","p√©ks√ºti","p√©kcucc","s√ºti","√ºccsi","√ºd√≠t≈ë","k√≥la","cola","narancsl√©","gy√ºm√∂lcsle","gy√ºmil√©","gy√∂mb√©r","sz√∂rp","pink tonik","pinktonik","pink tonic", "tej"],
        lidl: ["z√∂lds√©g", "gy√ºm√∂lcs", "keny√©r", "tej", "toj√°s"],
        spar: ["tej", "keny√©r", "toj√°s", "z√∂lds√©g", "gy√ºm√∂lcs"]
    };

    function normalize(text) {
        return text.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
    }

    // LISTA MENT√âSE FIREBASE-BE
    function saveToFirebase() {
        set(itemsRef, items);
    }

    // LISTA BET√ñLT√âSE FIREBASE-B≈êL (Realtime!)
    onValue(itemsRef, (snapshot) => {
        const data = snapshot.val();
        items = data || [];
        render();
    });

    function showApp() {
        document.getElementById("login").style.display = "none";
        document.getElementById("app").style.display = "block";
    }

    window.checkPass = function() {
        const userPass = document.getElementById("passInput").value;
        if(userPass === PASSWORD) {
            localStorage.setItem("bevListaPass", PASSWORD);
            showApp();
        } else {
            document.getElementById("error").textContent = "Helytelen jelsz√≥!";
        }
    };

    if(localStorage.getItem("bevListaPass") === PASSWORD) {
        showApp();
    }

    window.addItem = function() {
        const input = document.getElementById("itemInput");
        const value = input.value.trim();
        if (!value) return;

        const exists = items.some(item => normalize(item.name) === normalize(value));
        if (exists) {
            alert("Ez az elem m√°r szerepel a list√°ban!");
            input.value = "";
            return;
        }

        items.push({
            id: Date.now(),
            name: value,
            checked: false
        });

        input.value = "";
        sortItems(); // Ez h√≠vja meg a save-et
    };

    window.toggle = function(id) {
        const item = items.find(i => i.id === id);
        if (item) {
            item.checked = !item.checked;
            saveToFirebase();
        }
    };

    window.removeItem = function(id) {
        items = items.filter(i => i.id !== id);
        saveToFirebase();
    };

    window.clearList = function() {
        if (!confirm("Biztos t√∂rl√∂d az eg√©sz list√°t?")) return;
        items = [];
        saveToFirebase();
    };

    window.sortItems = function() {
        const store = document.getElementById("storeSelect").value;
        const order = storeOrders[store];
        items.sort((a, b) => {
            const ai = order.map(normalize).indexOf(normalize(a.name));
            const bi = order.map(normalize).indexOf(normalize(b.name));
            return (ai === -1 ? 999 : ai) - (bi === -1 ? 999 : bi);
        });
        saveToFirebase();
    };

    function render() {
        const ul = document.getElementById("list");
        ul.innerHTML = "";
        items.forEach(item => {
            const li = document.createElement("li");
            li.dataset.id = item.id;

            const left = document.createElement("div");
            left.className = "left";

            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.checked = item.checked;
            checkbox.onclick = () => window.toggle(item.id);

            const span = document.createElement("span");
            span.textContent = item.name;
            if (item.checked) span.className = "checked";

            left.appendChild(checkbox);
            left.appendChild(span);

            const del = document.createElement("button");
            del.textContent = "üóëÔ∏è";
            del.className = "delete";
            del.onclick = () => window.removeItem(item.id);

            li.appendChild(left);
            li.appendChild(del);
            ul.appendChild(li);
        });
    }

    // Esem√©nykezel≈ëk bek√∂t√©se (mivel module type-ot haszn√°lunk)
    document.getElementById("loginBtn").onclick = window.checkPass;
    document.getElementById("addBtn").onclick = window.addItem;
    document.getElementById("clearBtn").onclick = window.clearList;
    document.getElementById("storeSelect").onchange = window.sortItems;
    document.getElementById("itemInput").addEventListener("keypress", (e) => {
        if (e.key === "Enter") window.addItem();
    });

</script>
</body>
</html>
